(function(a){a.fn.xGallery=function(b){if(!b){var b={}}return this.each(function(){b.obj=this;new xGallery(b)})}}(jQuery));var xGallery=function(options,fx){this.options=$.extend({id:false,obj:false,animationType:"fade",animationSpeed:300,touchControl:true,keyControl:true,showPageNum:true,showPagePoints:true,showPageImages:"all",showImages:"all",showComments:false,showImageNum:true,buttonObj:false,title:false,border:110,beta:true},options);for(var name in this.options){eval("this."+name+"=this.options."+name)}this.count=0;this.activImage=0;this.imagesThumb=false;this.imgArray=new Array();this.imageNum=0;this.imagepage=1;this.imagePageCount=0;this.width=$(window).width();this.height=$(window).height();this.imgContainer=false;this.pageStatus=true;this.openStatus=false;this.openAnimationStatus=true;this.animationStatus=true;this.points=false;this.loader=false;this.init()};xGallery.prototype={init:function(){var a=this;if(this.options.obj){this.obj=this.options.obj}else{this.obj=$(this.options.id)}this.imagesThumb=$(this.obj).find("img");this.imageNum=$(this.imagesThumb).length;this.imagePageCount=Math.ceil(this.imageNum/this.showPageImages);$(this.imagesThumb).each(function(b,c){a.imgArray[b]=new Array();a.imgArray[b]["img"]=new Image();a.imgArray[b]["height"]=0;a.imgArray[b]["width"]=0;a.imgArray[b]["src"]=$(c).attr("data-img");a.imgArray[b]["thumb"]=c;a.imgArray[b]["comment"]=$(c).attr("data-comment")!=undefined?$(c).attr("data-comment"):"";if(a.showImages!="all"&&b>=a.showImages||a.buttonObj){$(c).parent("div").remove();$(c).remove()}});this.loadGallery()},loadGallery:function(){var a=this;var b=0;$(this.imagesThumb).each(function(c,d){a.imageLoader(d,function(){b++;if(b==a.imageNum){a.build()}},function(){a.message("Error load image "+(c+1));$(d).remove();a.imageNum--;if(b==a.imageNum){a.build()}})})},build:function(){var a=this;var b="<div class='prev_btn'></div>";b+="<div class='next_btn'></div>";if(this.showPageImages!="all"){$(this.obj).append("<div class='page-navigation'>"+b+"</div>");var c="";if(this.showPageNum){c+="<div class='page-num'>";c+="<span class='num'>"+this.imagepage+"</span>";c+="<span class='center'>/</span>";c+="<span class='pages'>"+this.imagePageCount+"</span>";c+="</div>";$(this.obj).append(c)}var d="";if(this.showPagePoints){d+="<div class='page-points'><div class='points-content'>";for(i=1;i<=this.imagePageCount;i++){d+="<div class='point'><span>"+(i)+"</span></div>"}d+="</div></div>";$(this.obj).append(d)}}if(this.showImageNum){b+="<div class='nummber'>"+(this.activImage+1)+"/"+this.imageNum+"</div>"}b+="<div class='close_btn'></div>";if(this.title){b+="<div class='gallery-title'>"+this.title+"</div>"}$(this.obj).append("<div class='surface'>"+b+"</div>");$(this.obj).find(".surface").append("<div class='border'></div>");$(this.obj).find(".surface").append("<div class='loader'><i class='fa fa-spinner fa-pulse'></i></div>");this.imagesThumb=$(this.obj).find("img");this.imgContainer=$(this.obj).find(".surface .border");this.loader=$(this.obj).find(".surface .loader");this.points=$(this.obj).find(".page-points .point");$(this.obj).find(".page-points .point").eq(this.imagepage-1).addClass("activ");this.startGallery()},startGallery:function(){var a=this;$(window).resize(function(){a.setSize()});$(this.buttonObj).click(function(){a.openGallery(0)});$(this.imagesThumb).click(function(){a.openGallery($(this).parent().index())});$(this.obj).find(".surface").click(function(b){var d=$(b.target).attr("class");if(d!="prev_btn"&&d!="next_btn"&&d!="image"){a.closeGallery()}});$(this.obj).find(".next_btn").click(function(){if(a.openStatus){a.nextImage()}else{a.nextPage()}});$(this.obj).find(".prev_btn").click(function(){if(a.openStatus){a.prevImage()}else{a.prevPage()}});$(this.obj).find(".page-points .point").click(function(b){var c=this;a.gotoPage($(this).index()+1)});if(this.touchControl){this.touchStart=false;this.touchEnd=false;$(this.obj).bind("touchstart",function(b){a.touchStart=false;a.touchEnd=0});$(this.obj).bind("touchmove",function(b){if(a.touchStart==false){a.touchStart=b.originalEvent.touches[0].pageX}a.touchEnd=b.originalEvent.touches[0].pageX});$(this.obj).bind("touchend",function(c){var b=a.touchEnd-a.touchStart;if(a.openStatus){if(b<0&&b<-50){a.nextImage()}if(b>0&&b>50){a.prevImage()}}else{if(b<0&&b<-50){a.nextPage()}if(b>0&&b>50){a.prevPage()}}a.touchStart=false;a.touchEnd=0})}if(this.keyControl){$(document).keydown(function(b){if(a.openStatus){if(b.keyCode==37){b.preventDefault();a.prevImage()}if(b.keyCode==39){b.preventDefault();a.nextImage()}}else{if(b.keyCode==37){b.preventDefault();a.prevPage()}if(b.keyCode==39){b.preventDefault();a.nextPage()}}})}if(this.showPageImages=="all"){$(this.imagesThumb).fadeIn(500)}else{$(this.imagesThumb).hide();$(this.imagesThumb).slice(0,this.showPageImages).show()}},openGallery:function(b){var a=this;if(b>=0&&b<this.imageNum){this.activImage=b;this.setStatus()}if(this.openAnimationStatus){this.openAnimationStatus=false;this.setSize();$(this.imgContainer).css("opacity",0);$("body").css("overflow","hidden");$(this.obj).find(".surface").fadeIn(500,function(){a.addImage(function(){a.addComment();$(a.imgContainer).animate({opacity:1},500,function(){a.openStatus=true;a.openAnimationStatus=true})})})}},closeGallery:function(){var a=this;if(this.openAnimationStatus){this.openStatus=false;this.openAnimationStatus=false;$(a.imgContainer).animate({opacity:1},200,function(){$(a.obj).find(".surface").fadeOut(500,function(){$("body").css("overflow","auto");a.openAnimationStatus=true})})}},animation:function(b){var a=this;switch(this.animationType){case"fade":$(this.imgContainer).animate({opacity:0},a.animationSpeed,function(){a.addImage(function(){a.addComment();$(a.imgContainer).animate({opacity:1},a.animationSpeed,function(){if(b){b()}})})});break;default:this.message("no Animation Type")}},nextImage:function(){var a=this;if(this.animationStatus){this.animationStatus=false;if(this.activImage<this.imageNum-1){this.activImage++}else{this.activImage=0}this.animation(function(){a.setStatus();a.animationStatus=true})}},prevImage:function(){var a=this;if(this.animationStatus){this.animationStatus=false;if(this.activImage>0){this.activImage--}else{this.activImage=this.imageNum-1}this.animation(function(){a.setStatus();a.animationStatus=true})}},gotoImage:function(b,c){var a=this;if(this.animationStatus){if(b>=0&&b<this.imageNum){this.activImage=b}this.animation(function(){a.animationStatus=true;a.setStatus();if(c){c()}})}},addImage:function(b){var a=this;$(this.loader).fadeIn(200);this.imgArray[this.activImage]["img"].src=this.imgArray[this.activImage]["src"];this.imageLoader(this.imgArray[this.activImage]["img"],function(c){$(a.loader).fadeOut(200);$(a.obj).find(".surface .border img").remove();$(a.obj).find(".surface .border").append(c);$(a.obj).find(".surface .border img").addClass("image");if(b){b()}},function(){})},addComment:function(){var a=this;if(this.showComments){$(a.obj).find(".surface .border div.comment").remove();$(a.obj).find(".surface .border").append("<div class='comment'>"+a.imgArray[a.activImage]["comment"]+"</div>")}},nextPage:function(){var a=this;if(this.pageStatus){this.pageStatus=false;if(this.showPageImages*a.imagepage<this.imageNum){this.imagepage++}else{this.imagepage=1}this.gotoPage(this.imagepage,function(){a.setStatus();a.pageStatus=true})}},prevPage:function(){var a=this;if(this.pageStatus){this.pageStatus=false;if(this.imagepage>1){this.imagepage--}else{this.imagepage=Math.ceil(this.imageNum/this.showPageImages)}this.gotoPage(this.imagepage,function(){a.setStatus();a.pageStatus=true})}},gotoPage:function(b,c){var a=this;if(b>0&&b<this.imageNum){this.imagepage=b;$(".page-num .num").html(this.imagepage);$(this.imagesThumb).hide();$(a.imagesThumb).slice((a.showPageImages*a.imagepage)-a.showPageImages,a.showPageImages*a.imagepage).show();$(a.points).removeClass("activ").eq(this.imagepage-1).addClass("activ");if(c){c()}a.setStatus()}},imageLoader:function(b,c,a){if(b.complete||b.readyState===4){b.src+="?d="+new Date().getTime();$(b).load(function(e,d,f){if(c){c(b)}}).error(function(){if(a){a(b)}})}else{if(c){c(b)}}},setSize:function(){var a=this;this.width=$(window).width();this.height=$(window).height();$(this.obj).find(".surface .border").css({width:this.width-this.border,height:this.height-this.border})},setStatus:function(){if(this.showImageNum){$(this.obj).find(".surface .nummber").html((this.activImage+1)+"/"+this.imageNum)}},message:function(a){if(this.beta){if($("#cis_error_message").length){var b="<div class='cis_error_message' style='font-size:10px; text-align:left; line-height: 25px; border-bottom:solid 1px #ddd; padding-left:5px;'><div>";$("#cis_error_message_titel").after(b);$(".cis_error_message").first().text("- "+a)}else{var b="<div id='cis_error_message' style='position:absolute; top:10px; left:10px; z-index:100000; height:100px; width:250px; border:solid 2px #000; display:none;background-color:#fff; overflow: auto;'>";b+="<h3 id='cis_error_message_titel' style='display:block; text-align:center; background-color:#666; color:#fff; font-size:12px; line-height: 25px!important; margin:0px;'>Console</h3>";b+="<div class='cis_error_message' style='font-size:10px; text-align:left; line-height: 25px; border-bottom:solid 1px #ddd; padding-left:5px;'><div>";b+="</div>";$(this.obj).append(b);$(".cis_error_message").text("- "+a);$("#cis_error_message").fadeIn(500)}}}};